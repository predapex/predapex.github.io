<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Water Transfer System</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
    }

    svg {
      border: 1px solid #ccc;
      margin-top: 20px;
    }

    .valve {
      cursor: pointer;
      fill: red;
      stroke: black;
      stroke-width: 1;
    }

    .valve.open {
      fill: green;
    }

    .tank {
      fill: lightblue;
      stroke: #000;
      stroke-width: 1;
    }

    .pipe {
      stroke: #bbb;
      stroke-width: 8;
      fill: none;
    }

    .pump {
      fill: #666;
    }

    .flow-line {
      stroke: blue;
      stroke-width: 3;
      stroke-dasharray: 6;
      stroke-dashoffset: 0;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .flow-active {
      opacity: 1;
      animation: flow 0.7s linear infinite;
    }

    @keyframes flow {
      0% { stroke-dashoffset: 0; }
      100% { stroke-dashoffset: -12; }
    }

    .label {
      font-size: 14px;
      font-weight: bold;
    }

    button {
      margin: 10px;
    }
  </style>
</head>
<body>
  <h2>Interactive Water Transfer System</h2>
  <button onclick="togglePump()">Pump: <span id="pumpState">OFF</span></button>
  <svg width="900" height="500">
    <!-- Tanks -->
    <rect x="100" y="50" width="60" height="100" class="tank"/>
    <text x="130" y="45" text-anchor="middle" class="label">Tank 1</text>
    <line x1="130" y1="50" x2="130" y2="30" class="pipe"/>
    <line x1="130" y1="150" x2="130" y2="200" class="pipe"/>

    <rect x="280" y="50" width="60" height="100" class="tank"/>
    <text x="310" y="45" text-anchor="middle" class="label">Tank 2</text>
    <line x1="310" y1="50" x2="310" y2="30" class="pipe"/>
    <line x1="310" y1="150" x2="310" y2="200" class="pipe"/>

    <rect x="460" y="50" width="60" height="100" class="tank"/>
    <text x="490" y="45" text-anchor="middle" class="label">Tank 3</text>
    <line x1="490" y1="50" x2="490" y2="30" class="pipe"/>
    <line x1="490" y1="150" x2="490" y2="200" class="pipe"/>

    <rect x="640" y="50" width="60" height="100" class="tank"/>
    <text x="670" y="45" text-anchor="middle" class="label">Tank 4</text>
    <line x1="670" y1="50" x2="670" y2="30" class="pipe"/>
    <line x1="670" y1="150" x2="670" y2="200" class="pipe"/>

    <!-- Suction manifold -->
    <line x1="100" y1="200" x2="760" y2="200" class="pipe"/>
    <rect x="115" y="185" width="30" height="30" class="valve" id="suction-valve-1" onclick="toggleValve(1, 'suction')"/>
    <line x1="130" y1="215" x2="130" y2="250" class="pipe"/>
    <rect x="295" y="185" width="30" height="30" class="valve" id="suction-valve-2" onclick="toggleValve(2, 'suction')"/>
    <line x1="310" y1="215" x2="310" y2="250" class="pipe"/>
    <rect x="475" y="185" width="30" height="30" class="valve" id="suction-valve-3" onclick="toggleValve(3, 'suction')"/>
    <line x1="490" y1="215" x2="490" y2="250" class="pipe"/>
    <rect x="655" y="185" width="30" height="30" class="valve" id="suction-valve-4" onclick="toggleValve(4, 'suction')"/>
    <line x1="670" y1="215" x2="670" y2="250" class="pipe"/>

    <!-- Pump -->
    <rect x="420" y="250" width="60" height="40" class="pump"/>
    <text x="450" y="275" text-anchor="middle" fill="white">Pump</text>

    <!-- Return manifold -->
    <line x1="100" y1="320" x2="760" y2="320" class="pipe"/>
    <rect x="115" y="305" width="30" height="30" class="valve" id="return-valve-1" onclick="toggleValve(1, 'return')"/>
    <line x1="130" y1="290" x2="130" y2="320" class="pipe"/>
    <rect x="295" y="305" width="30" height="30" class="valve" id="return-valve-2" onclick="toggleValve(2, 'return')"/>
    <line x1="310" y1="290" x2="310" y2="320" class="pipe"/>
    <rect x="475" y="305" width="30" height="30" class="valve" id="return-valve-3" onclick="toggleValve(3, 'return')"/>
    <line x1="490" y1="290" x2="490" y2="320" class="pipe"/>
    <rect x="655" y="305" width="30" height="30" class="valve" id="return-valve-4" onclick="toggleValve(4, 'return')"/>
    <line x1="670" y1="290" x2="670" y2="320" class="pipe"/>

    <!-- Flow lines -->
    <line x1="130" y1="200" x2="450" y2="270" class="flow-line" id="flow-suction-1"/>
    <line x1="450" y1="270" x2="130" y2="320" class="flow-line" id="flow-return-1"/>
    <line x1="310" y1="200" x2="450" y2="270" class="flow-line" id="flow-suction-2"/>
    <line x1="450" y1="270" x2="310" y2="320" class="flow-line" id="flow-return-2"/>
    <line x1="490" y1="200" x2="450" y2="270" class="flow-line" id="flow-suction-3"/>
    <line x1="450" y1="270" x2="490" y2="320" class="flow-line" id="flow-return-3"/>
    <line x1="670" y1="200" x2="450" y2="270" class="flow-line" id="flow-suction-4"/>
    <line x1="450" y1="270" x2="670" y2="320" class="flow-line" id="flow-return-4"/>
  </svg>

  <script>
    let pumpOn = false;
    const openValves = { suction: new Set(), return: new Set() };

    function togglePump() {
      pumpOn = !pumpOn;
      document.getElementById("pumpState").innerText = pumpOn ? "ON" : "OFF";
      updateFlow();
    }

    function toggleValve(id, side) {
      const el = document.getElementById(`${side}-valve-${id}`);
      if (openValves[side].has(id)) {
        openValves[side].delete(id);
        el.classList.remove("open");
      } else {
        openValves[side].add(id);
        el.classList.add("open");
      }
      updateFlow();
    }

    function updateFlow() {
      for (let i = 1; i <= 4; i++) {
        const flowSuction = document.getElementById(`flow-suction-${i}`);
        const flowReturn = document.getElementById(`flow-return-${i}`);
        const show = pumpOn && openValves.suction.has(i) && openValves.return.has(i);
        flowSuction.setAttribute("class", show ? "flow-line flow-active" : "flow-line");
        flowReturn.setAttribute("class", show ? "flow-line flow-active" : "flow-line");
      }
    }
  </script>
</body>
</html>
